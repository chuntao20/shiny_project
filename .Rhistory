geom_col(aes(fill=brand),width=0.5) +
theme_bw()
china %>%
group_by(brand) %>%
summarise(num_of_store = n()) %>%
ggplot(., aes(x=brand,y=num_of_store)) +
geom_col(aes(fill=brand),width=0.5) +
theme_bw()
usa %>%
group_by(brand) %>%
summarise(num_of_store = n()) %>%
ggplot(., aes(x=brand,y=num_of_store)) +
geom_col(aes(fill=brand),width=0.5) +
theme_bw()
ny %>%
group_by(brand) %>%
summarise(num_of_store = n()) %>%
ggplot(., aes(x=brand,y=num_of_store)) +
geom_col(aes(fill=brand),width=0.5) +
theme_bw()
data2 %>%
group_by(brand) %>%
summarise(num_of_store = n()) %>%
ggplot(., aes(x=brand,y=num_of_store)) +
geom_col(aes(fill=brand),width=0.5) +
theme_bw()
data2 %>%
filter(brand=='Coffee House Holdings' | brand=='Evolution Fresh') %>%
group_by(brand,country) %>%
summarise(num_of_store = n())
data2 %>%
filter(brand=='Teavana') %>%
group_by(brand,country) %>%
summarise(num_of_store = n())
data2 %>%
group_by(ownership_type) %>%
summarise(num_of_store = n()) %>%
ggplot(., aes(x=ownership_type,y=num_of_store)) +
geom_col(aes(fill=ownership_type),width=0.5) +
theme_bw()
data2 %>%
filter(ownership_type == 'Franchise') %>%
unique(country)
data2 %>%
filter(ownership_type == 'Franchise') %>%
select(country) %>%
unique()
data2 %>%
filter(ownership_type == 'Franchise') %>%
group_by(country) %>%
summarise(num = n())
data2 %>%
filter(ownership_type == 'Joint Venture') %>%
group_by(country) %>%
summarise(num = n())
data2 %>%
filter(ownership_type == 'Licensed') %>%
group_by(country) %>%
summarise(num = n())
data2 %>%
filter(country %in% c('France, French Republic','United Kingdom of Great Britain & Northern Ireland')) %>%
group_by(ownership_type) %>%
summarise(num = n())
data2 %>%
filter(country %in% c('France, French Republic','United Kingdom of Great Britain & Northern Ireland')) %>%
group_by(country,ownership_type) %>%
summarise(num = n())
data2 %>%
filter(country %in% c('France, French Republic','United Kingdom of Great Britain & Northern Ireland')) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aex(x=ownership_type,y=num)) +
geom_bar(aes(color=ownership_type),stat='identity')
data2 %>%
filter(country %in% c('France, French Republic','United Kingdom of Great Britain & Northern Ireland')) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=ownership_type,y=num)) +
geom_bar(aes(color=ownership_type),stat='identity')
data2 %>%
filter(country %in% c('France, French Republic','United Kingdom of Great Britain & Northern Ireland')) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=ownership_type,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity')
data2 %>%
filter(country %in% c('France, French Republic','United Kingdom of Great Britain & Northern Ireland')) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity')
data2 %>%
filter(country %in% c('France, French Republic','United Kingdom of Great Britain & Northern Ireland')) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill')
data2 %>%
filter(country %in% c('France, French Republic','United Kingdom of Great Britain & Northern Ireland')) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill') +
coord_polar()
data2 %>%
filter(country %in% c('France, French Republic','United Kingdom of Great Britain & Northern Ireland')) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill')
data2 %>%
filter(ownership_type == 'Joint Venture') %>%
select(country) %>%
unique()
JV_country = data2 %>%
filter(ownership_type == 'Joint Venture') %>%
select(country) %>%
unique()
data2 %>%
filter(country %in% JV_country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill')
data2 %>%
filter(country %in% JV_country) %>%
group_by(country,ownership_type)
JV_country = as.vector(JV_country)
data2 %>%
filter(country %in% JV_country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill')
data2 %>%
filter(country %in% JV_country) %>%
group_by(country,ownership_type) %>%
summarise(num = n())
JV_country
JV_country = as.vector(JV_country)
JV_country
class(JV_country)
JV_country = as.vector(JV_country)
class(JV_country)
JV_country$country
data2 %>%
filter(country %in% JV_country$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n())
data2 %>%
filter(country %in% JV_country$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill')
data2 %>%
filter(country %in% JV_country$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
data2 %>%
filter(country %in% JV_country$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5))
data2 %>%
filter(country %in% JV_country$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill') +
theme(axis.text.x = element_text(angle = 45))
hjust=1
data2 %>%
filter(country %in% JV_country$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
shiny::runApp('shiny')
data2 %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10)
top10 = data2 %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10)
data2 %>%
filter(country %in% top10$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
data2 %>%
filter(country %in% top10$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=reorder(country,desc(num)),y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
data2 %>%
filter(country %in% top10$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=reorder(country,desc(sum(num))),y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
data2 %>%
filter(country %in% top10$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=reorder(top10$country,desc(top10$total)),y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
data2 %>%
filter(country %in% top10$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n())
data2 %>%
filter(country %in% top10$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=reorder(country,num),y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
data2 %>%
filter(country %in% top10$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=reorder(country,num),y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='dodge') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
data2 %>%
filter(country %in% top10$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=reorder(country,num),y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
JV_country = data2 %>%
filter(ownership_type == 'Joint Venture') %>%
select(country) %>%
unique()
data2 %>%
filter(ownership_type == 'Joint Venture') %>%
select(country) %>%
unique()
data2 %>%
filter(ownership_type == 'Joint Venture') %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total))
data2 %>%
filter(country %in% JV_country$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='fill') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
data2 %>%
filter(country %in% JV_country$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n())
data2 %>%
filter(country %in% JV_country$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='dodge') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
data2 %>%
group_by(country) %>%
summarise(total = n())
data2 %>%
group_by(continent,country) %>%
summarise(total = n())
leaflet(data=data2) %>% addTiles() %>%
addMarkers(
clusterOptions = markerClusterOptions()
)
data2 %>%
filter(country %in% JV_country$country) %>%
group_by(country,ownership_type) %>%
summarise(num = n()) %>%
ggplot(aes(x=country,y=num)) +
geom_bar(aes(fill=ownership_type),stat='identity',position='dodge') +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
data2 %>%
group_by(brand) %>%
summarise(num_of_store = n()) %>%
ggplot(., aes(x=brand,y=num_of_store)) +
geom_col(aes(fill=brand),width=0.5) +
theme_bw()
data2 %>%
filter(ownership_type == 'Joint Venture') %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total))
write.csv(data2,'/shiny/world.csv',row.names=F)
write.csv(data2,'./shiny/world.csv',row.names=F)
world = read.csv('world.csv',header=T)
setwd("~/NYCDSA/shiny_project/shiny")
world = read.csv('world.csv',header=T)
head(world)
dim(world)
unique(world$country)
country = unique(world$country)
unique(world$ownership_type)
ownership = unique(world$ownership_type)
unique(world$brand)
brand = unique(world$brand)
continent = unique(world$continent)
datatable(world, rownames=FALSE)
nrow(world)
renderInfoBox({
num_store <- nrow(world)
infoBox("Number of stores", num_store)
})
unique(world$country)
nrow(unique(world$country))
length(unique(world$country))
gvisGeoChart(state_stat, "state.name", input$selected,
options=list(region="US", displayMode="regions",
resolution="provinces",
width="auto", height="auto"))
library(googleVis)
data2 %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10)
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10)
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=country,y=total)) +
geom_col() +
theme_bw()
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,desc(total)),y=total)) +
geom_col() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,desc(total)),y=total)) +
geom_col(aes(fill=country)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,desc(total)),y=total)) +
geom_col(fill='green') +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,desc(total)),y=total)) +
geom_col(fill='dark green') +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,desc(total)),y=total)) +
geom_col(fill='dark green') +
theme_bw() +
coord_flip() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,total),y=total)) +
geom_col(fill='dark green') +
theme_bw() +
coord_flip() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,total),y=total)) +
geom_col(fill='dark green') +
theme_bw() +
coord_flip()
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,total),y=total)) +
geom_col(fill='dark green') +
theme_bw() +
coord_flip() +
ylab('Number of store')
output$store_by_top10 = renderPlot(
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,total),y=total)) +
geom_col(fill='dark green') +
theme_bw() +
coord_flip() +
ylab('')
)
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,total),y=total)) +
geom_col(fill='dark green') +
theme_bw() +
coord_flip() +
ylab('')
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,total),y=total)) +
geom_col(fill='dark green') +
theme_bw() +
coord_flip() +
ylab('fdfd')
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,total),y=total)) +
geom_col(fill='dark green') +
theme_bw() +
coord_flip() +
ylab('Number of store') +
xlab('Country')
world %>%
group_by(country) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
top_n(10) %>%
ggplot(aes(x=reorder(country,total),y=total)) +
geom_col(fill='dark green') +
theme_bw() +
coord_flip() +
ylab('Number of store') +
xlab('Country')
world %>%
group_by(continent) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
ggplot(aes(x=continent,y=total)) +
geom_col(fill='dark green') +
theme_bw() +
coord_flip() +
ylab('Number of store') +
xlab('Continent')
world %>%
#filter(continent == input$continent) %>%
group_by(continent) %>%
summarise(total=n()) %>%
arrange(desc(total)) %>%
ggplot(aes(x=reorder(continent,total),y=total)) +
geom_col(fill='dark green') +
theme_bw() +
coord_flip() +
ylab('Number of store') +
xlab('Continent')
gvisGeoChart(world, "country", 'Profit' )
world %>%
group_by(country) %>%
summarise(total=n())
world_store = world %>%
group_by(country) %>%
summarise(total=n())
gvisGeoChart(world_store, "country", 'Profit', 'total')
runApp()
